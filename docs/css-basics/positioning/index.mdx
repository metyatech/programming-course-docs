---
sidebar_position: 4.5
---

import Exercise, { Solution } from '@metyatech/exercise/client';
import { CodePreview } from '@metyatech/code-preview';

# 位置指定（position）

CSSの`position`は、要素を「通常の文書の流れ」からどのように配置するかを決めるプロパティです。**初期値は`static`（通常の配置）** です。

本ページでは、よく使う4種類の配置方法を学びます。

- `relative`（相対配置）
- `fixed`（画面に固定）
- `sticky`（スクロールに応じて貼り付く）
- `absolute`（絶対配置）

## 今日の学習はこんなところで使うよ

ニュースサイトやショッピングサイトなど、実際のWebサイトでは position が様々な場面で使われています。以下は、スクロール可能な記事ページの例です。

- **fixed**: ページ上部のヘッダーと右下の「TOPへ戻る」ボタン
- **sticky**: スクロール時に上部に貼り付くカテゴリータブ
- **absolute**: 商品カードの右上に重なる「NEW」バッジ
- **relative**: アイコンの位置微調整

<CodePreview 
  htmlVisible={false}
  cssVisible={false}
  consoleVisible={false}
  previewVisible={true}
>
```html
<header class="header">
  <span class="logo">📰 NEWS SITE</span>
</header>

<div class="hero">
  <h1>最新ニュースをチェック</h1>
  <p>毎日更新される最新情報をお届けします</p>
</div>

<nav class="category-tabs">
  <span class="tab active">すべて</span>
  <span class="tab">テクノロジー</span>
  <span class="tab">ビジネス</span>
</nav>

<main class="content">
  <section class="article">
    <h2 class="section-title">今日のニュース</h2>
    
    <article class="news-card">
      <div class="news-image"></div>
      <span class="badge">NEW</span>
      <h3>新製品が発表されました <span class="icon">🔥</span></h3>
      <p>本日、最新のスマートフォンが発表され...</p>
    </article>
    
    <article class="news-card">
      <div class="news-image"></div>
      <h3>セール開催中 <span class="icon">🎉</span></h3>
      <p>期間限定で最大50%オフのセールを...</p>
    </article>
    
    <div style="height: 400px; padding: 20px; background: #f9f9f9; border: 1px dashed #ddd; display: flex; align-items: center; justify-content: center; color: #999;">
      （さらに記事が続く...スクロールしてみてください）
    </div>
  </section>
</main>

<button class="scroll-top">TOP</button>
```

```css
body {
  margin: 0;
  font-family: sans-serif;
}

/* fixed: 画面上部に固定されるヘッダー */
.header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 56px;
  background: #1976d2;
  color: #fff;
  display: flex;
  align-items: center;
  padding: 0 16px;
  box-shadow: 0 2px 4px rgba(0,0,0,.1);
  z-index: 100;
}

.logo {
  font-size: 18px;
  font-weight: bold;
}

/* ヒーローエリア: stickyタブの前にスペースを作る */
.hero {
  margin-top: 56px;
  padding: 40px 20px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: #fff;
  text-align: center;
}

.hero h1 {
  margin: 0 0 12px;
  font-size: 24px;
}

.hero p {
  margin: 0;
  opacity: 0.9;
}

/* sticky: スクロール時に上部に貼り付くカテゴリータブ */
.category-tabs {
  position: sticky;
  top: 56px;
  background: #fff;
  border-bottom: 1px solid #e0e0e0;
  padding: 12px 16px;
  display: flex;
  gap: 16px;
  z-index: 50;
  box-shadow: 0 2px 4px rgba(0,0,0,.05);
}

.tab {
  padding: 6px 12px;
  border-radius: 16px;
  font-size: 14px;
  cursor: pointer;
  transition: background .2s;
}

.tab.active {
  background: #e3f2fd;
  color: #1976d2;
  font-weight: 600;
}

.content {
  padding-top: 20px;
  padding-bottom: 40px;
}

.article {
  max-width: 600px;
  margin: 0 auto;
  padding: 0 16px;
}

.section-title {
  padding: 12px 0;
  margin: 0 0 16px;
  border-bottom: 2px solid #1976d2;
}

/* relative: バッジ配置の基準 & アイコン位置調整 */
.news-card {
  position: relative;
  background: #fff;
  border: 1px solid #e0e0e0;
  border-radius: 8px;
  padding: 16px;
  margin-bottom: 16px;
  box-shadow: 0 1px 3px rgba(0,0,0,.1);
}

.news-image {
  height: 160px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: 4px;
  margin-bottom: 12px;
}

/* absolute: カード右上に重ねるバッジ */
.badge {
  position: absolute;
  right: 12px;
  top: 12px;
  background: #ff5722;
  color: #fff;
  padding: 4px 8px;
  font-size: 11px;
  font-weight: bold;
  border-radius: 4px;
  box-shadow: 0 2px 4px rgba(0,0,0,.2);
}

.news-card h3 {
  margin: 0 0 8px;
  font-size: 18px;
}

.news-card p {
  margin: 0;
  color: #666;
  line-height: 1.6;
}

/* relative: アイコンを少し上に調整 */
.icon {
  position: relative;
  top: -1px;
  font-size: 16px;
}

/* fixed: 画面右下に固定されるボタン */
.scroll-top {
  position: fixed;
  right: 20px;
  bottom: 20px;
  width: 48px;
  height: 48px;
  border-radius: 50%;
  border: none;
  background: #1976d2;
  color: #fff;
  font-size: 12px;
  font-weight: bold;
  cursor: pointer;
  box-shadow: 0 2px 8px rgba(0,0,0,.3);
  z-index: 50;
}

.scroll-top:hover {
  background: #1565c0;
}
```
</CodePreview>

---

## 概観：position とオフセット

- `position`に`static`以外を指定すると、`top`/`right`/`bottom`/`left`/`z-index`で要素の位置を調整できます。
- `top`/`right`/`bottom`/`left` で位置を指定します。
- `z-index`で重なり順を指定します。数値が大きい方が手前に表示されます。

### 4つのpositionの違いを比較

以下の例で、真ん中のB（青）にそれぞれ異なる`position`を指定した場合の動作を確認してください。

<CodePreview
>
```html
<h4>static（初期値）</h4>
<div class="wrap">
  <div class="box a">A</div>
  <div class="box b static">B<br><small>static</small></div>
  <div class="box c">C</div>
</div>

<h4>relative</h4>
<div class="wrap">
  <div class="box a">A</div>
  <div class="box b relative">B<br><small>relative</small></div>
  <div class="box c">C</div>
</div>

<h4>absolute</h4>
<div class="wrap" style="position: relative;">
  <div class="box a">A</div>
  <div class="box b absolute">B<br><small>absolute</small></div>
  <div class="box c">C</div>
</div>

<h4>fixed</h4>
<div class="wrap">
  <div class="box a">A</div>
  <div class="box b fixed">B<br><small>fixed</small></div>
  <div class="box c">C</div>
</div>

<h4>sticky（スクロールしてみてください）</h4>
<div class="wrap scroll">
  <p style="height: 50px; background: #f7f7f7;">（長い内容1）</p>
  <div class="box a">A</div>
  <div class="box b sticky">B<br><small>sticky</small></div>
  <div class="box c">C</div>
  <p style="height: 400px; background: #f7f7f7;">（長い内容2）</p>
</div>
```

```css
.wrap {
  height: 80px;
  border: 2px dashed #999;
  margin-bottom: 20px;
}

.wrap.scroll {
  height: 200px;
  overflow: auto;
}

.box {
  width: 60px;
  height: 60px;
  text-align: center;
  color: #fff;
  display: inline-block;
  padding-top: 8px;
  vertical-align: top;
}

.box small {
  font-size: 9px;
  opacity: 0.8;
}

.a {
  background: #4caf50;
}

.b {
  background: #2196f3;
}

.c {
  background: #f44336;
}

.static {
  /* position: static; は初期値なので指定不要 */
}

.relative {
  position: relative;
  left: 20px;
  top: 10px;
}

.absolute {
  position: absolute;
  right: 20px;
  top: 10px;
}

.fixed {
  position: fixed;
  right: 80px;
  top: 60px;
}

.sticky {
  position: sticky;
  top: 0;
}
```
</CodePreview>

---

## relative（相対配置）

- 要素は「元の位置」を基準に少しだけ動かせます。

<CodePreview
>
```html
<div class="wrap">
  <div class="box a">A</div>
  <div class="box b">B</div>
  <div class="box c">C</div>
</div>
```

```css
.wrap {
  border: 2px dashed #999;
}

.box {
  width: 60px;
  height: 60px;
  text-align: center;
  color: #fff;
}

.a {
  background: #4caf50;
}

.b {
  background: #2196f3;
  position: relative;
  left: 20px;
  top: 10px;
}

.c {
  background: #f44336;
}
```
</CodePreview>

真ん中のB（青）に`position: relative; left: 20px; top: 10px;`を指定しています。元の位置から右に20px、下に10pxずれますが、A・Cの配置には影響しません。

**上のサンプルで`left`や`top`の値を変更してみて、どのように動くか確認してみましょう。**

### よくある用途
- 微調整（アイコンやバッジを少しずらす）

---

## fixed（画面に固定）

- ビューポート（画面）を基準に常に同じ位置に固定されます。
- 文書の流れから外れる（その場のスペースを占有しない）。
- スクロールしても動きません。
- ナビゲーションバー、フッターバー、戻るボタンなどで活躍します。

<CodePreview
>
```html
<div class="wrap">
  <div class="box a">A</div>
  <div class="box b">B</div>
  <div class="box c">C</div>
</div>
<p>スクロールしてみてください。</p>
<p style="height: 4000px; background: #f7f7f7;">（長い空白）</p>
<p>おわり</p>
```

```css
.wrap {
  border: 2px dashed #999;
}

.box {
  width: 60px;
  height: 60px;
  text-align: center;
  color: #fff;
}

.a {
  background: #4caf50;
}

.b {
  background: #2196f3;
  position: fixed;
  right: 20px;
  bottom: 20px;
}

.c {
  background: #f44336;
}
```
</CodePreview>

真ん中のB（青）に`position: fixed; right: 20px; bottom: 20px;`を指定しています。画面の右下に固定され、スクロールしても常に同じ位置に表示されます。A・CはBが無かったかのように詰まって表示されます。

<Exercise title="演習1（固定ボタン）">

class="top" のついたボタンが、下のプレビューのような見た目になるように、CSSを書いてください。

<CodePreview 
  sourceId="pos-ex1"
  htmlVisible={true}
  cssVisible={false}
  previewVisible={true}
>
```html
<div style="height: 4000px; background: #f7f7f7; padding: 8px;">長いページ（スクロール）</div>
<!-- ↓この要素にCSSを適用 -->
<button class="top">TOP</button>
```

```css
.top {
  position: fixed;
  right: 16px;
  bottom: 16px;
  width: 48px;
  height: 48px;
  border-radius: 50%;
  border: none;
  background: #1976d2;
  color: #fff;
  font-weight: bold;
  box-shadow: 0 2px 6px rgba(0,0,0,.2);
}
```
</CodePreview>

<Solution>

<CodePreview sourceId="pos-ex1" htmlVisible={true} cssVisible={true} previewVisible={true} />

</Solution>

</Exercise>

<Exercise title="演習1-発展（モーダルウィンドウ）">

.overlay と .modal が、下のプレビューのように画面中央に固定表示されるように、CSSを書いてください。
.overlay は画面全体を覆う半透明の背景、.modal は白いボックスです。

<CodePreview 
  sourceId="pos-ex1-adv"
  htmlVisible={true}
  cssVisible={false}
  previewVisible={true}
>
```html
<div style="height: 4000px; background: #f7f7f7; padding: 16px;">
  <p>ページの内容（スクロールしてもモーダルは画面中央に固定されます）</p>
</div>
<!-- ↓この要素にCSSを適用 -->
<div class="overlay"></div>
<!-- ↓この要素にCSSを適用 -->
<div class="modal">
  <h3 style="margin: 0 0 12px;">お知らせ</h3>
  <p style="margin: 0;">新機能が追加されました。</p>
</div>
```

```css
.overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
}

.modal {
  padding: 20px;
  background: #fff;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);

  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}
```
</CodePreview>

:::tip ヒント
モーダルを画面中央に配置するには、`top`、`left` を `50%` に設定し、`transform: translate(-50%, -50%);` で要素の中心を基準点に合わせる方法を考えてみましょう。
:::


<Solution>

<CodePreview sourceId="pos-ex1-adv" htmlVisible={true} cssVisible={true} previewVisible={true} />

解説:
- `.overlay` を `position: fixed` で画面全体を覆う半透明の背景として配置します。
- `top: 0; left: 0; right: 0; bottom: 0;` で画面全体を覆います。
- `.modal` も `position: fixed` で画面中央に固定します。
- `top: 50%; left: 50%;` で左上を中央に配置し、`transform: translate(-50%, -50%);` でモーダル自体の中心を画面中央に合わせます。

</Solution>

</Exercise>


---

## sticky（スクロールで貼り付く）

- ふだんは`relative`のように流れの中にいますが、指定した位置（例：`top: 0`）までスクロールされると、その位置で「固定」されます。

<CodePreview
>
```html
<div class="wrap">
  <div class="box a">A</div>
  <div class="box b">B</div>
  <div class="box c">C</div>
  <p style="height: 4000px; background: #f7f7f7;">（長い内容）</p>
</div>
```

```css
.wrap {
  border: 2px dashed #999;
}

.box {
  width: 60px;
  height: 60px;
  text-align: center;
  color: #fff;
}

.a {
  background: #4caf50;
}

.b {
  background: #2196f3;
  position: sticky;
  top: 0;
}

.c {
  background: #f44336;
}
```
</CodePreview>

真ん中のB（青）に`position: sticky; top: 0;`を指定しています。最初は通常の流れで配置されますが、スクロールすると上端（`top: 0`）に貼り付きます。

### よくある用途
- 長文のセクション見出しを上部に貼り付けて見失わないようにする
- サイドバーを一定の位置に貼り付ける

<Exercise title="演習2（stickyな見出し）">

h4.pin が、下のプレビューのようにスクロール時に上部へ貼り付くように、CSSを書いてください。  
その際、メニューの背景が透けて下のテキストが見えないように設定してください。

<CodePreview 
  sourceId="pos-ex2"
  htmlVisible={true}
  cssVisible={false}
  previewVisible={true}
>
```html
<div class="hero" style="padding: 40px 16px; background: linear-gradient(135deg, #667eea, #764ba2); color: #fff; text-align: center;">
  <h2 style="margin: 0 0 8px;">ページタイトル</h2>
  <p style="margin: 0;">サブタイトル</p>
</div>
<!-- ↓この要素にCSSを適用 -->
<h4 class="pin">メニュー1 | メニュー2 | メニュー3</h4>
<p>内容A-1</p>
<p style="height: 4000px; background:#f7f7f7;">（長文）</p>
```

```css
.pin {
  margin: 0;
  padding: 8px 12px;

  position: sticky;
  top: 0;
  background: #fff;
  border-bottom: 1px solid #eee;
}
```
</CodePreview>

<Solution>

<CodePreview sourceId="pos-ex2" htmlVisible={true} cssVisible={true} previewVisible={true} />

</Solution>

</Exercise>

<Exercise title="演習2-発展1（stickyサイドバー）">

左カラムの aside.sidebar が、下のプレビューのように親コンテナ内で上部に貼り付くように、CSSを書いてください。

<CodePreview 
  sourceId="pos-ex2-adv"
  htmlVisible={true}
  cssVisible={false}
  previewVisible={true}
>
```html

<body style="display: flex; gap: 16px;">
  <!-- ↓この要素にCSSを適用 -->
  <aside class="sidebar">メニュー1<br>メニュー2<br>メニュー3</aside>
  <section style="flex: 1; border: 1px solid #ddd; padding: 8px;">本文…<div style="height: 4000px;"></div>おわり</section>
</body>
```

```css
.sidebar {
  width: 160px;
  height: fit-content;
  padding: 8px;
  border: 1px solid #ccc;

  position: sticky;
  top: 10px;
}
```
</CodePreview>

<Solution>

<CodePreview sourceId="pos-ex2-adv" htmlVisible={true} cssVisible={true} previewVisible={true} />

</Solution>

</Exercise>

<Exercise title="演習2-発展2（stickyヘッダー）">

header.head が、下のプレビューのようになるように CSS を書いてください（ヘッダーはスクロールで上部に貼り付く）。

<CodePreview 
  sourceId="pos-ex2-adv-header"
  htmlVisible={true}
  cssVisible={false}
  previewVisible={true}
>
```html
<body style="margin: 0;">
  <!-- ↓この要素にCSSを適用 -->
  <header class="head">Site Title</header>
  <main class="page">
    <p>本文の先頭</p>
    <p style="height: 4000px; background:#f7f7f7;">（長文）</p>
  </main>
</body>
```

```css
.head {
  height: 56px;
  background: #333;
  color: #fff;

  position: sticky;
  top: 0;
}
```
</CodePreview>

<Solution>

<CodePreview sourceId="pos-ex2-adv-header" htmlVisible={true} cssVisible={true} previewVisible={true} />

</Solution>

</Exercise>

<Exercise title="演習2-発展3（複数stickyの積み重なり）">

h3.lv3 と h4.lv4 の見出しが、下のプレビューのように上下に積み重なって貼り付くように、CSSを書いてください。

<CodePreview 
  sourceId="pos-ex2-plus"
  htmlVisible={true}
  cssVisible={false}
  previewVisible={true}
>
```html
<p style="height: 50px; background:#fafafa;">（ちょっとした文章）</p>
<!-- ↓この2つの要素にCSSを適用 -->
<h3 class="lv3">章タイトル</h3>
<h4 class="lv4">節タイトル</h4>
<p style="height: 4000px; background:#fafafa;">（本文）</p>
```

```css
.lv3 {
  height: 40px;

  position: sticky;
  top: 0;
  border-bottom: 1px solid #eee;
  background: #fff;
}

.lv4 {
  height: 35px;

  position: sticky;
  top: 41px; /* lv3の高さ(40px) + 境界線(1px) */
  border-bottom: 1px solid #eee;
  background: #fff;
}
```
</CodePreview>

<Solution>

<CodePreview sourceId="pos-ex2-plus" htmlVisible={true} cssVisible={true} previewVisible={true} />

</Solution>

</Exercise>

---

## absolute（絶対配置）

- 一番近い「positionが`static`以外」の祖先要素を基準に、好きな位置へ配置します。
- 文書の流れから外れる（その場のスペースを占有しない）。
- 基準となる親がいない場合は、ページ全体を基準に配置されます。

<CodePreview
>
```html
<div class="wrap">
  <div class="box a">A</div>
  <div class="box b">B</div>
  <div class="box c">C</div>
</div>
```

```css
.wrap {
  position: relative;
  border: 2px dashed #999;
}

.box {
  width: 60px;
  height: 60px;
  text-align: center;
  color: #fff;
}

.a {
  background: #4caf50;
}

.b {
  background: #2196f3;
  position: absolute;
  right: 0;
  top: 20px;
}

.c {
  background: #f44336;
}
```
</CodePreview>

真ん中のB（青）に`position: absolute; right: 0; top: 20px;`を指定しています。`position: relative` な親の`.wrap`を基準に右上に配置されます。文書の流れから外れるためA・Cが詰まって表示されます。

### よくある用途
- カードの右上や右下にラベル/アイコンを重ねる
- ツールチップ、吹き出し

<Exercise title="演習3（absoluteで角に配置）">

span.tag のラベルが、下のプレビューのようにカード右上へ重なる見た目になるように、CSSを書いてください。

<CodePreview 
  sourceId="pos-ex3"
  htmlVisible={true}
  cssVisible={false}
  previewVisible={true}
>
```html
<div class="card">
  <h3>お知らせ</h3>
  <p>新機能をリリースしました。</p>
  <!-- ↓主にこの要素にCSSを適用 -->
  <span class="tag">NEW</span>
</div>
```

```css
.card {
  width: 300px;
  padding: 16px;
  border: 1px solid #ccc;

  position: relative;
}

.tag {
  background: rgba(0,0,0,.6);
  color: #fff;
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 12px;

  position: absolute;
  right: 8px;
  top: 8px;
}
```
</CodePreview>

<Solution>

<CodePreview sourceId="pos-ex3" htmlVisible={true} cssVisible={true} previewVisible={true} />

</Solution>

</Exercise>

<Exercise title="演習3-発展（ツールチップ）">

btn クラスのついたボタンにカーソルを載せると、下のプレビューのように span.tooltip が表示されるように、CSSを書いてください。

<CodePreview 
  sourceId="pos-ex3-adv"
  htmlVisible={true}
  cssVisible={false}
  previewVisible={true}
>
```html
<div style="padding: 60px; text-align: center;">
  <button class="btn">
    ヘルプ
    <!-- ↓主にこの要素にCSSを適用 -->
    <span class="tooltip">クリックすると詳細が表示されます</span>
  </button>
</div>
```

```css
.btn {
  padding: 8px 16px;
  background-color: #1976d2;
  color: #fff;
  border: none;
  border-radius: 4px;
  cursor: pointer;

  position: relative;
}

.tooltip {
  visibility: hidden;
  background-color: rgba(0,0,0,.8);
  color: #fff;
  padding: 6px 10px;
  border-radius: 4px;
  font-size: 13px;
  white-space: nowrap;

  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%);
  margin-bottom: 6px;
}

.btn:hover .tooltip {
  visibility: visible;
}
```
</CodePreview>


:::tip ヒント①「ボタンの上に配置するには？」
ツールチップの `bottom` に `%` を使うと、親要素（ボタン）の高さに応じて位置が変わります。これを巧みに利用しましょう。例えば、`bottom: 30%;` とすると、ツールチップの下端がボタンの下端からボタンの高さの30%分上に配置されますね。
:::

:::tip ヒント②「左右中央に揃えるには？」
ツールチップをボタンの左右中央に揃えたい場合は、`left: 50%;` としてツールチップの左端をボタンの左右中央の位置に配置してから、`transform: translateX(-50%);` で自身の幅の半分だけ左にずらすことで、左右中央に表示することができます。
:::

:::tip ヒント③「表示/非表示の切り替え（visibility）」
`visibility` プロパティで、要素の「見える／見えない」を切り替えることができます。  
`visibility: hidden;` で非表示、`visibility: visible;` で表示されます。
:::

<Solution>

<CodePreview sourceId="pos-ex3-adv" htmlVisible={true} cssVisible={true} previewVisible={true} />

解説:
- ボタンに `position: relative` を指定して、ツールチップの基準にします。
- ツールチップは `position: absolute` で配置し、初期状態は `visibility: hidden` で非表示にします。
- `bottom: 100%` でボタンの上に配置し、`left: 50%` と `transform: translateX(-50%)` で中央揃えにします。
- `margin-bottom: 6px` でボタンとの間に少しスペースを作ります。
- ボタンにカーソルを載せたとき（`:hover`）だけ、内側のツールチップを `visibility: visible` で表示します。

</Solution>

</Exercise>

---

## 使い分けのヒント

- `relative`は「微調整」や「absoluteの基準のためのマーカー」として使うのが基本。
- `fixed`は画面基準。通常のフローから取り除かれるため、ドロワーメニューやフローティングボタンなど、その要素の領域の確保が必要ない場合に便利。
- `sticky`も、基本は画面基準。通常のフローから取り除かれないため、ヘッダーやサイドメニューなど、その要素の領域の確保が必要な場合に便利。
- `absolute`は「重ねたい・正確に置きたい」時に。流れから外れるため、過剰に使うとレイアウトが壊れやすい。
